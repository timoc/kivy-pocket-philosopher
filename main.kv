#:kivy 1.8.0
#:import get_random_color kivy.utils.get_random_color

# DEBUG WIDGETS
#<Widget>:
#    canvas.after:
#        Line:
#            rectangle: self.x+1, self.y+1, self.width-1, self.height-1
#            dash_offset: 5
#            dash_length: 3

# DEBUG A WIDGET
#            canvas.after:
#                Color:
#                    rgba: 1, 0, 0, 0.5
#                Line:
#                    rectangle: self.x+1, self.y+1, self.width-1, self.height-1
#                Color:
#                    rgba: 0, 0, 1, 0.3
#                Rectangle:
#                    pos: self.pos
#                    size: self.size

<DynButton@Button>:
    markup: True

<MainActionBar@ActionBar>
    pos_hint: {'top':1}
    ActionView:
        use_separator: True
        ActionPrevious:
            with_previous: False
        ActionOverflow:
        ActionButton:
            text: "Help"
            on_press: root.help_popup()
        ActionButton:
            id: btn_settings
            on_press: app.open_settings()
            text: "Settings"
        ActionButton:
            text: "About"
            on_press: root.about_popup()
        ActionButton:
            on_press: app.stop()
            text: "Exit"


<Main>:
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'top'
        ScreenManager:
            size_hint: 1, .9
            id: _screen_manager
            Screen:
                name: 'Main'
                BoxLayout:
                    orientation: "vertical"
                    MainActionBar:
                    RelativeLayout:
                        Image:
                            id: bg
                            width: root.width
                            height: root.height
                            keep_ratio: True
                            allow_stretch: True
                            auto_bring_to_front: False
                        Scatter:
                            size_hint: None, None
                            size: aphorism.size
                            Label:
                                id: aphorism
                                font_size: root.height / 20
                                markup: True
                                text: 'Shall we?'
                                text_size: root.width, None
                                size_hint_y: None
                                size: self.texture_size
                                canvas.before:
                                    Color:
                                        #rgba: get_random_color(0.3)
                                        rgba: 0, 0, 0, 0.4
                                    Rectangle:
                                        pos: self.pos
                                        size: self.size
                    BoxLayout:
                        size_hint_y: '0.1sp'
                        DynButton:
                            id: btn_random
                            on_press: root.btn_random()
                            text: "Random"
            Screen:
                name: 'Test'
                BoxLayout:
                    orientation: "vertical"
                    MainActionBar:
                    BoxLayout:
                        size_hint_y: 0.1
                        DynButton:
                            id: 'Test'
                            text: 'Test'
    AnchorLayout:
        anchor_x: 'center'
        anchor_y: 'bottom'
        BoxLayout:
            orientation: 'horizontal'
            size_hint: 1, .1
            Button:
                text: 'Go to Screen 1'
                on_press: _screen_manager.current = 'Main'
            Button:
                text: 'Go to Screen 2'
                on_press: _screen_manager.current = 'Test'

<AboutPopup>:
    size_hint: .65, .8
    auto_dismiss: False
    title: 'About Aforgizmo'
    BoxLayout:
        orientation: "vertical"
        padding: 2
        spacing: 10
        Label:
            text_size: self.width, None
            markup: True
            text: 'This app was written by [b]Vijay Mahrra[/b].\n\n[i]http://about.me/vijay.mahrra[/i]\n\nComments, issues and feedback to: [b]vijay.mahrra@gmail.com[/b]\n\n'
        Button:

            text: 'OK'
            on_press: root.dismiss()

<HelpPopup>:
    size_hint: .5, .5
    auto_dismiss: False
    title: 'Aforgizmo Help'
    BoxLayout:
        orientation: "vertical"
        padding: 2
        spacing: 10
        Label:
            size_hint_y: None
            text_size: self.width, None
            markup: True
            text: 'No help available yet!'
        Button:
            text: 'OK'
            on_press: root.dismiss()
